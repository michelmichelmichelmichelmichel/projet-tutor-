<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exploration PyrÃ©nÃ©es - Tourisme Durable</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div id="app-container">
        <!-- Map Container -->
        <div id="map"></div>

        <!-- âš™ï¸ Floating Appearance Button + Panel -->
        <button id="settings-toggle-btn" class="glass-btn icon-btn"
            style="position: absolute; top: 20px; left: 420px; z-index: 1001; width: 45px; height: 45px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; transition: all 0.3s ease;">âš™ï¸</button>

        <div id="appearance-settings-panel" class="glass-panel hidden"
            style="position: absolute; top: 75px; left: 420px; width: 280px; padding: 20px; z-index: 1001; transition: all 0.3s ease;">
            <h3
                style="font-size: 0.9rem; margin-bottom: 12px; color: var(--color-primary); text-transform: uppercase; letter-spacing: 0.05em; display: flex; justify-content: space-between; align-items: center;">
                ğŸ¨ Apparence
                <span id="close-settings" style="cursor:pointer; opacity: 0.6; font-size: 1.2rem;">âœ•</span>
            </h3>

            <div class="filter-section">
                <label
                    style="color: #fff; font-size: 0.85rem; display: flex; align-items: center; justify-content: space-between;">
                    <span>Ã‰paisseur des tracÃ©s</span>
                    <span id="path-weight-value" style="color: var(--color-primary); font-weight: bold;">100%</span>
                </label>
                <input type="range" id="path-weight-slider" min="50" max="300" value="100" step="10"
                    style="width: 100%; margin-top: 8px; cursor: pointer; accent-color: var(--color-primary);">
            </div>

            <div class="filter-section"
                style="margin-top: 15px; display: flex; align-items: center; justify-content: space-between;">
                <label style="color: #fff; font-size: 0.85rem;">Couleur de la zone</label>
                <input type="color" id="polygon-color-picker" value="#3388ff"
                    style="cursor: pointer; border: none; width: 40px; height: 25px; padding: 0; background: none; border-radius: 4px;">
            </div>
        </div>

        <!-- Macro View Overlay (Statistics & Instructions) -->
        <div id="macro-overlay" class="glass-panel visible">
            <header style="display: flex; justify-content: space-between; align-items: start;">
                <div>
                    <h1>Exploration des POIs</h1>
                    <p class="subtitle">Vers un tourisme plus durable</p>
                </div>
                <button id="minimize-macro-btn" class="icon-btn minimize-btn" title="RÃ©duire/Agrandir">âˆ’</button>
            </header>
            <div class="instructions">
                <p>ğŸ“ <strong>Mode Macro :</strong> Utilisez l'outil de dessin <span class="icon-draw">â¬ </span> pour
                    sÃ©lectionner une zone.</p>

                <div class="filter-section" style="margin-top: 15px;">
                    <button id="toggle-filters-btn" class="glass-btn"
                        style="width: 100%; text-align: left; font-size: 0.9rem; padding: 8px;">ğŸ› ï¸ Choisir les
                        catÃ©gories POIs (Tout)</button>
                    <div id="macro-filters-content"
                        style="display: none; margin-top: 10px; max-height: 250px; overflow-y: auto; background: rgba(0,0,0,0.2); padding: 10px; border-radius: 8px;">
                        <button id="deselect-all-btn" class="glass-btn small"
                            style="width: 100%; margin-bottom: 8px; font-size: 0.8rem;">Tout cocher/dÃ©cocher</button>
                    </div>
                </div>

                <div class="filter-section" style="margin-top: 10px;">
                    <button id="toggle-path-filters-btn" class="glass-btn"
                        style="width: 100%; text-align: left; font-size: 0.9rem; padding: 8px;">ğŸ—ºï¸ Choisir les chemins
                        (Tout)</button>
                    <div id="path-filters-content"
                        style="display: none; margin-top: 10px; max-height: 250px; overflow-y: auto; background: rgba(0,0,0,0.2); padding: 10px; border-radius: 8px;">
                        <button id="deselect-all-paths-btn" class="glass-btn small"
                            style="width: 100%; margin-bottom: 8px; font-size: 0.8rem;">Tout cocher/dÃ©cocher</button>
                        <!-- Path Checkboxes injected here -->
                    </div>
                </div>

                <div id="macro-stats" class="stats-grid">
                    <!-- Stats will be injected here -->
                    <div class="stat-item empty">
                        <span class="stat-value">--</span>
                        <span class="stat-label">Points d'IntÃ©rÃªt</span>
                    </div>
                </div>

            </div>
        </div>

        <!-- Micro View Sidebar (POI List & Details) -->
        <aside id="micro-sidebar" class="glass-panel">
            <div class="sidebar-header">
                <h2>Points d'IntÃ©rÃªt</h2>
                <button id="close-micro-view" class="icon-btn" aria-label="Retour Ã  la vue macro">âœ•</button>
            </div>

            <div class="filters-container">
                <select id="category-filter">
                    <option value="all">ğŸŒ Toutes catÃ©gories</option>
                    <option value="tourism">ğŸ“· Tourisme</option>
                    <option value="sustenance">ğŸ´ Restauration</option>
                    <option value="accommodation">ğŸ›ï¸ HÃ©bergement</option>
                    <option value="leisure">ğŸ¡ Loisirs</option>
                    <option value="sport">âš½ Sport</option>
                    <option value="historic">ğŸ›ï¸ Histoire & Patrimoine</option>
                    <option value="natural">ğŸŒ³ Nature</option>
                    <option value="shop">ğŸ›’ Commerces</option>
                    <option value="amenity">ğŸš» Services Divers</option>
                    <option value="transport">ğŸšŒ Transport</option>
                    <option value="healthcare">âš•ï¸ SantÃ©</option>
                    <option value="emergency">ğŸš¨ Urgence</option>
                    <option value="office">ğŸ’¼ Bureaux</option>
                    <option value="craft">ğŸ¨ Artisanat</option>
                    <option value="man_made">ğŸ—ï¸ Infrastructures</option>
                    <option value="power">âš¡ Ã‰nergie</option>
                    <option value="barrier">ğŸš§ BarriÃ¨res</option>
                    <option value="place">ğŸ“ Lieux & Villes</option>
                </select>
                <input type="text" id="poi-search-input" placeholder="Rechercher par nom..." class="search-input"
                    style="width: 100%; margin-top: 10px; padding: 10px; border-radius: 8px; border: 1px solid var(--glass-border); background: rgba(0,0,0,0.3); color: white;">
                <div id="sub-category-filter-container"
                    style="margin-top: 10px; display: flex; flex-wrap: wrap; gap: 5px;"></div>
            </div>

            <div id="poi-list" class="poi-list">
                <!-- POI Items will be injected here -->
                <p class="empty-state">SÃ©lectionnez une zone pour voir les lieux.</p>
            </div>
        </aside>


        <!-- Presets Panel (Tabbed) -->
        <div id="presets-panel" class="glass-panel">
            <div class="presets-tabs"
                style="display: flex; justify-content: space-between; align-items: center; padding-right: 10px;">
                <div style="display: flex; flex: 1; overflow-x: auto;">
                    <button class="tab-btn active" data-tab="national">Parcs Nationaux</button>
                    <button class="tab-btn" data-tab="regional">Parcs RÃ©gionaux</button>
                    <button class="tab-btn" data-tab="regions">RÃ©gions</button>
                    <button class="tab-btn" data-tab="departments">DÃ©partements</button>
                    <button class="tab-btn" data-tab="cities">Villes</button>
                </div>
                <button id="minimize-presets-btn" class="icon-btn minimize-btn" title="RÃ©duire/Agrandir"
                    style="padding: 4px 8px;">âˆ’</button>
            </div>

            <div id="national-content" class="tab-content active">
                <div id="national-list" class="presets-list">
                    <!-- National Parks injected here -->
                </div>
            </div>

            <div id="regional-content" class="tab-content">
                <div id="regional-list" class="presets-list">
                    <!-- Regional Parks injected here -->
                </div>
            </div>

            <div id="regions-content" class="tab-content">
                <div id="regions-list" class="presets-list">
                    <!-- Regions injected here -->
                </div>
            </div>

            <div id="departments-content" class="tab-content">
                <div id="departments-list" class="presets-list">
                    <!-- Departments injected here -->
                </div>
            </div>

            <div id="cities-content" class="tab-content">
                <div class="search-container" style="padding: 10px 0;">
                    <input type="text" id="city-search-input" placeholder="Rechercher une commune..."
                        style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.2); color: white;">
                </div>
                <div id="cities-results" class="presets-list">
                    <!-- Search results injected here -->
                    <p class="empty-state" style="font-size: 0.85rem; color: var(--color-text-muted);">Tapez le nom
                        d'une
                        ville...</p>
                </div>
            </div>
        </div>

    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.js"></script>
    <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>

    <!-- Application Modules -->
    <script type="module" src="app.js"></script>
</body>

</html>